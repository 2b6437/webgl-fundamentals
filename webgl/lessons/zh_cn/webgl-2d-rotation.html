<!DOCTYPE html>
<!-- this file is auto-generated from webgl/lessons/zh_cn/webgl-2d-rotation.md. Do not edited directly -->
<!--
Copyright 2012, Gregg Tavares.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

*   Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

*   Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.

*   Neither the name of Gregg Tavares. nor the names of his
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta property="og:title" content="WebGL 二维旋转" />
<meta property="og:type" content="website" />
<meta property="og:image" content="http://webglfundamentals.org/webgl/lessons/resources/webglfundamentals.jpg" />
<meta property="og:description" content="如何在二维中旋转" />
<meta property="og:url" content="http://webglfundamentals.org/webgl/lessons/zh_cn/webgl-2d-rotation.html" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@greggman" />
<meta name="twitter:creator" content="@greggman" />
<meta name="twitter:domain" content="webglfundamentals.org" />
<meta name="twitter:title" content="WebGL 二维旋转" />
<meta name="twitter:url" content="http://webglfundamentals.org/webgl/lessons/zh_cn/webgl-2d-rotation.html" />
<meta name="twitter:description" content="如何在二维中旋转" />
<meta name="twitter:image:src" content="http://webglfundamentals.org/webgl/lessons/resources/webglfundamentals.jpg" />


<title>WebGL 二维旋转</title>
<link href="/webgl/lessons/resources/webglfundamentals-icon.png" rel="shortcut icon" type="image/png">
<link rel="stylesheet" href="/webgl/lessons/resources/lesson.css" type="text/css" />
</head>
<body>
<div class="webgl_navbar">
  <div>
    <select class="language">
    <option value="/webgl/lessons/webgl-2d-rotation.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-2d-rotation.html" >Français</a>
    <option value="/webgl/lessons/ja/webgl-2d-rotation.html" >日本語</a>
    <option value="/webgl/lessons/pl/webgl-2d-rotation.html" >Polski</a>
    <option value="/webgl/lessons/ru/webgl-2d-rotation.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-2d-rotation.html" selected>简体中文</a>
</select>


    <a href="#toc">目录</a>
  </div>
</div>
<div class="webgl_header">
  <h1><a href="/webgl/lessons/zh_cn/">WebGLFundamentals.org</a></h1>
</div>


<div class="container">
  <div class="lesson-title">
    <h1>WebGL 二维旋转</h1>
  </div>
  <div class="lesson">
    <div class="lesson-main">
      <p>此文上接一系列文章，先<a href="webgl-fundamentals.html">从基础概念开始</a>，上一篇是
<a href="webgl-2d-translation.html">物体平移</a>。</p>
<p>我承认我不知道怎么解释比较好，但是管它呢！先试试吧。</p>
<p>首先我想向你介绍一个叫做“单位圆”的东西。如果你还记得初中数学的话（别睡着了啊~喂！），
一个圆有一个半径，圆的半径是圆心到圆边缘的距离。单位圆是半径为 1.0 的圆。</p>
<p>这里有个单位圆。</p>
<p><div class="webgl_diagram_container">
  <iframe class="webgl_example " style="width: 300px; height: 300px;" src="/webgl/lessons/../unit-circle.html"></iframe>
</div>

</p>
<p>当你拖拽蓝色圆点的时候 X 和 Y 会改变，它们是那一点在圆上的坐标，
在最上方时 Y 是 1 并且 X 是 0 ，在最右边的时候 X 是 1 并且 Y 是 0 。</p>
<p>如果你还记得三年级的数学知识，数字和 1 相乘结果不变。
例如 123 * 1 = 123 。非常基础，对吧？那么，单位圆，半径为 1.0 
的圆也是 1 的一种形式，它是旋转的 1 。所以你可以把一些东西和单位圆相乘，
除了发生一些魔法和旋转之外，某种程度上和乘以 1 相似。</p>
<p>我们将从单位元上任取一点，并将该点的 X 和 Y 与<a href="webgl-2d-translation.html">之前例子</a>
中的几何体相乘。</p>
<p>这是新的着色器。</p>
<pre><code>&lt;script id=&quot;2d-vertex-shader&quot; type=&quot;x-shader/x-vertex&quot;&gt;
attribute vec2 a_position;

uniform vec2 u_resolution;
uniform vec2 u_translation;
+uniform vec2 u_rotation;

void main() {
+  // 旋转位置
+  vec2 rotatedPosition = vec2(
+     a_position.x * u_rotation.y + a_position.y * u_rotation.x,
+     a_position.y * u_rotation.y - a_position.x * u_rotation.x);

  // 加上平移
*  vec2 position = rotatedPosition + u_translation;
</code></pre><p>更新JavaScript，传递两个值进去。</p>
<pre><code>  ...

+  var rotationLocation = gl.getUniformLocation(program, &quot;u_rotation&quot;);

  ...

+  var rotation = [0, 1];

  ...

  // 绘制场景
  function drawScene() {

    ...

    // 设置平移
    gl.uniform2fv(translationLocation, translation);

+    // 设置旋转
+    gl.uniform2fv(rotationLocation, rotation);

    // 绘制几何体
    var primitiveType = gl.TRIANGLES;
    var offset = 0;
    var count = 18;  // 6 个三角形组成 &#39;F&#39;, 每个三角形 3 个点
    gl.drawArrays(primitiveType, offset, count);
  }
</code></pre><p>这是结果，拖动圆形手柄来旋转或拖动滑块来平移。</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-2d-geometry-rotation.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-2d-geometry-rotation.html" target="_blank">点此在新窗口中浏览</a>
</div>

</p>
<p>为什么会这样？来看看数学公式。</p>
<pre><code>rotatedX = a_position.x * u_rotation.y + a_position.y * u_rotation.x;
rotatedY = a_position.y * u_rotation.y - a_position.x * u_rotation.x;
</code></pre><p>假如你想旋转一个矩形，在开始旋转之前矩形右上角坐标是 3.0, 9.0 ，
让我们在单位圆上以十二点方向为起点顺时针旋转30度后取一个点。</p>
<p><img src="../../resources/rotate-30.png" class="webgl_center" /></p>
<p>圆上该点的位置是 0.50 和 0.87</p>
<pre class="webgl_center">
   3.0 * 0.87 + 9.0 * 0.50 = 7.1
   9.0 * 0.87 - 3.0 * 0.50 = 6.3
</pre>

<p>这个结果正好是我们需要的结果</p>
<p><img src="../../resources/rotation-drawing.svg" width="500" class="webgl_center"/></p>
<p>顺时针60度也一样</p>
<p><img src="../../resources/rotate-60.png" class="webgl_center" /></p>
<p>圆上该点的位置是 0.87 和 0.50 。</p>
<pre class="webgl_center">
   3.0 * 0.50 + 9.0 * 0.87 = 9.3
   9.0 * 0.50 - 3.0 * 0.87 = 1.9
</pre>

<p>你会发现在我们顺时针旋转到右边的过程中，X 变大 Y 变小。如果我们继续旋转超过90
度后，X 变小 Y 变大，这种形式形成了旋转。</p>
<p>单位圆上的点还有一个名字，叫做正弦和余弦。所以对于任意给定角，
我们只需要求出正弦和余弦，像这样</p>
<pre><code>function printSineAndCosineForAnAngle(angleInDegrees) {
  var angleInRadians = angleInDegrees * Math.PI / 180;
  var s = Math.sin(angleInRadians);
  var c = Math.cos(angleInRadians);
  console.log(&quot;s = &quot; + s + &quot; c = &quot; + c);
}
</code></pre><p>如果你吧代码复制到JavaScript控制台，然后输入 <code>printSineAndCosignForAngle(30)</code> ，
会打印出 <code>s = 0.49 c = 0.87</code> (注意：我对结果四舍五入了)。</p>
<p>如果你把这些组合起来，就可以对几何体旋转任意角度，使用时只需要设置旋转的角度。</p>
<pre><code>  ...
  var angleInRadians = angleInDegrees * Math.PI / 180;
  rotation[0] = Math.sin(angleInRadians);
  rotation[1] = Math.cos(angleInRadians);
</code></pre><p>这里有一个设置角度的版本，拖动滑块来旋转或平移。</p>
<p><div class="webgl_example_container">
  <iframe class="webgl_example" style=" " src="/webgl/resources/editor.html?url=/webgl/lessons/..%2Fwebgl-2d-geometry-rotation-angle.html"></iframe>
  <a class="webgl_center" href="/webgl/lessons/../webgl-2d-geometry-rotation-angle.html" target="_blank">点此在新窗口中浏览</a>
</div>

</p>
<p>希望我解释的还过得去，这并不是旋转常用的方式，请继续阅读，
我们将会在2篇文章后讲旋转的通用方式，<a href="webgl-2d-scale.html">下一篇比较简单，缩放</a>。</p>
<div class="webgl_bottombar"><h3>弧度是什么?</h3>
<p>
弧度是圈，旋转和角度的一个单位。就像可以用英尺，米，码等单位来表示距离一样，我们可以用角度或弧度来量测角。
</p>
<p>
你可能会发现国际测量单位比皇家测量单位更好用。从英寸到英尺要乘以12，从英寸到码要乘以36，我不知道你怎么样但是我无法心算乘以36。但是国际单位就好用多了，从千米到百米需要乘以10，从千米到米需要乘以1000。我<strong>可以</strong>心算乘以1000。
</p>
<p>
弧度和角度的对比是相似的，角度不易计算，弧度简单一些。一圈有360度但是只有 2π 弧度。所以一半是 1π 弧度，90度是 1/2π 弧度。如果想旋转90度只需要使用<code>Math.PI * 0.5</code>，45度只需要使用<code>Math.PI * 0.25</code>，以此类推。
</p>
<p>
涉及角度，圈或旋转的计算用弧度去思考一般会简单一些。试一试吧，使用弧度代替角度，尤其在有用户交互的地方。
</p>
</div>



    </div>
    <div class="lesson-sidebar">
        <select class="language">
    <option value="/webgl/lessons/webgl-2d-rotation.html" >English</a>
    <option value="/webgl/lessons/fr/webgl-2d-rotation.html" >Français</a>
    <option value="/webgl/lessons/ja/webgl-2d-rotation.html" >日本語</a>
    <option value="/webgl/lessons/pl/webgl-2d-rotation.html" >Polski</a>
    <option value="/webgl/lessons/ru/webgl-2d-rotation.html" >Русский</a>
    <option value="/webgl/lessons/zh_cn/webgl-2d-rotation.html" selected>简体中文</a>
</select>


        <div id="toc">
          <ul>
  <li>基础概念</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-fundamentals.html">WebGL 基础概念</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-how-it-works.html">WebGL 工作原理</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-shaders-and-glsl.html">WebGL 着色器和GLSL</a></li>
  </ul>
  <li>图像处理</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-image-processing.html">WebGL 图像处理</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-image-processing-continued.html">WebGL 进一步处理图像</a></li>
  </ul>
  <li>二维平移，旋转，缩放和矩阵运算</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-2d-translation.html">WebGL 二维平移</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-2d-rotation.html">WebGL 二维旋转</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-2d-scale.html">WebGL 二维缩放</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-2d-matrices.html">WebGL 二维矩阵</a></li>
  </ul>
  <li>三维</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-orthographic.html">WebGL 三维正射投影</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-perspective.html">WebGL 三维透视投影</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-camera.html">WebGL 三维相机</a></li>
  </ul>
  <li>光照</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-directional.html">WebGL 三维方向光源</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-point.html">WebGL 三维点光源</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-lighting-spot.html">WebGL 三维聚光灯</a></li>
  </ul>
  <li>组织和重构</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-less-code-more-fun.html">WebGL 码少趣多</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-drawing-multiple-things.html">WebGL 绘制多个物体</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-scene-graph.html">WebGL 场景图</a></li>
  </ul>
  <li>几何</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-geometry-lathe.html">WebGL 三维几何加工</a></li>
  </ul>
  <li>纹理</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-textures.html">WebGL 三维纹理</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-data-textures.html">WebGL 数据纹理</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-2-textures.html">WebGL 使用多个纹理</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-cors-permission.html">WebGL 跨域图像</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-3d-perspective-correct-texturemapping.html">WebGL 纹理映射的透视纠正</a></li>
  </ul>
  <li>渲染到纹理</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-render-to-texture.html">WebGL 渲染到纹理</a></li>
  </ul>
  <li>技术</li>
  <ul>
    <li>二维</li>
    <ul>
      <li><a href="/webgl/lessons/zh_cn/webgl-2d-drawimage.html">WebGL 二维DrawImage</a>
      <li><a href="/webgl/lessons/zh_cn/webgl-2d-matrix-stack.html">WebGL 二维矩阵栈</a>
    </ul>
    <li>文字</li>
    <ul>
      <li><a href="/webgl/lessons/zh_cn/webgl-text-html.html">WebGL 文字 - HTML</a>
      <li><a href="/webgl/lessons/zh_cn/webgl-text-canvas2d.html">WebGL 文字 - 二维Canvas</a>
      <li><a href="/webgl/lessons/zh_cn/webgl-text-texture.html">WebGL 文字 - 使用纹理</a>
      <li><a href="/webgl/lessons/zh_cn/webgl-text-glyphs.html">WebGL 文字 - 使用字形纹理</a>
    </ul>
  </ul>
  <li>杂项</li>
  <ul>
    <li><a href="/webgl/lessons/zh_cn/webgl-setup-and-installation.html">WebGL 设置和安装</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-boilerplate.html">WebGL 样板</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-resizing-the-canvas.html">WebGL 重置画布尺寸</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-animation.html">WebGL 动画</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-and-alpha.html">WebGL 和阿尔法通道</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-2d-vs-3d-library.html">WebGL 2D vs 3D 库</a></li>
    <li><a href="/webgl/lessons/zh_cn/webgl-anti-patterns.html">WebGL 错误模式</a></li>
  </ul>
</ul>
<ul>
  <li><a href="/docs/">API 帮助文档</a></li>
  <li><a href="http://twgljs.org">TWGL, 一个轻量级WebGL辅助库</a></li>
  <li><a href="https://github.com/greggman/webgl-fundamentals">GitHub</a></li>
</ul>

        </div>
    </div>
    <div class="lesson-comments">
        <div>有关于WebGL的疑问? <a href="http://stackoverflow.com/questions/tagged/webgl">在Stackoverflow提问</a>。</div>
        <div>有意见或建议? <a href="http://github.com/vinci-mz/webgl-fundamentals/issues">在GitHub上提issue</a>。</div>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'webglfundamentals'; // required: replace example with your forum shortname
            var disqus_identifier = 'WebGL 二维旋转';
            var disqus_title = 'WebGL 二维旋转';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                if (window.location.hostname.indexOf("webglfundamentals.org") < 0) {
                    return;
                }
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  </div>
</div>
</body>
<script src="/3rdparty/jquery-1.11.2.min.js"></script>
<script src="/webgl/lessons/resources/prettify.js"></script>
<script src="/webgl/lessons/resources/lesson.js"></script>
<script src="//cdn.webglstats.com/stat.js" defer="defer" async="async"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59804936-1', 'auto');
  ga('send', 'pageview');

</script>


</html>



